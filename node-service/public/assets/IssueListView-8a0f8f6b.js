import{P as L,L as F,m as q,i as N,_ as C,r as o,o as l,c as a,b as t,d as r,t as h,f as d,F as p,w as c,u as k,x as w,g as j,p as P,h as $}from"./index-f2a25bd4.js";import{F as A,M as D,V as M,I as R,a as T,b as U,f as z,i as E,u as O}from"./service.version-50db337e.js";import{P as G}from"./Pagination-f2621c08.js";const J={name:"ServiceInstaller",components:{ProjectSelect:L,DirectorySelect:F,FieldSetting:A,MySqlFieldSelect:D,VariableInput:M,InstallRadio:R,InstallInput:T,InstallCheckbox:U},props:{space:{required:!0},service:{required:!0},version:{required:!0},withProject:{default:!0},projectConfig:{},withBreadcrumbs:{default:!1},withInstallButton:{default:!1}},data(){return{variables:[]}},computed:{...q(["currentProject","currentDatabase"]),serviceVariables(){return this.variables.filter(e=>e.scope==="service")},unique(){return[this.space,this.service,this.version]}},watch:{unique(){this.fetchVersion()}},methods:{...N(["setCurrentProject"]),fetchVersion(){z({space:this.space,service:this.service,version:this.version}).then(e=>{this.variables=JSON.parse(e.variables).map(s=>s.type==="variable"&&s.scope==="service"?{...s,value:this.__getVariableValue(s)}:s.type==="group"&&s.scope==="service"?(s.children=s.children.map(n=>({...n,value:this.__getVariableValue(n)})),s):(s.type==="group"&&s.scope==="table_field"&&(s.value=this.__getVariableValue(s)),s))}).catch(e=>{this.$tip.apiFailed(e)})},install(){E({projectId:this.currentProject,database:this.currentDatabase,space:this.space,service:this.service,version:this.version,variables:this.variables}).then(()=>{this.$emit("installed")}).catch(e=>{this.$emit("error",e)})},uninstall(){O({projectId:this.currentProject,database:this.currentDatabase,space:this.space,service:this.service,version:this.version,variables:this.variables}).then(()=>{this.$emit("uninstalled")}).catch(e=>{this.$emit("error",e)})},__getVariableValue(e){let s=null;if(this.projectConfig!=null){const n=this.projectConfig.services[this.service];if(n!=null&&(s=n.variables[e.name]),s==null&&(e.type==="variable"||e.type==="group"&&e.scope==="service")){let f=null;for(const _ in this.projectConfig.main){f=_;break}const u=this.projectConfig.main[f].variables[e.name];s=u,u!=null&&u.constructor!==e.defaultValue.constructor&&(s=null)}}return s==null&&(s=e.defaultValue),s}},created(){this.fetchVersion()}},x=e=>(P("data-v-548041b5"),e=e(),$(),e),H={class:"service-installer"},K={key:0,class:"nav"},Q={class:"title"},W={class:"content-wrap"},X=x(()=>t("p",{class:"install-tip"}," tips: Install the service by filling out the form below and clicking the Install button at the bottom. ",-1)),Y={class:"form-wrap"},Z={key:1,class:"label-wrap"},ee={key:1,class:"group-vars"},te={class:"text-info-1 text-mini"},se=x(()=>t("div",{class:"parameters-holder"},[t("p",null,"This service does not have any parameters, click the INSTALL button at the bottom to install.")],-1)),le={key:1,class:"install"};function ne(e,s,n,f,u,_){const m=o("el-button"),g=o("ProjectSelect"),b=o("el-form-item"),y=o("ArrowRight"),I=o("el-icon"),S=o("VariableInput"),B=o("el-form");return l(),a("div",H,[n.withBreadcrumbs?(l(),a("div",K,[t("div",Q,[r(m,{class:"button-icon",icon:"ArrowLeftBold",onClick:s[0]||(s[0]=i=>e.$emit("back"))}),t("h4",null,h(n.service)+h(n.version==null?"":" · "+n.version.toUpperCase())+" · Install",1)])])):d("",!0),t("div",W,[n.withProject||_.serviceVariables.length>0?(l(),a(p,{key:0},[X,t("div",Y,[r(B,null,{default:c(()=>[n.withProject?(l(),k(b,{key:0,label:"Project",required:""},{default:c(()=>[r(g,{"model-value":e.currentProject,"with-block":!0,"with-prefix":!1,onChange:e.setCurrentProject},null,8,["model-value","onChange"])]),_:1})):d("",!0),(l(!0),a(p,null,w(_.serviceVariables,i=>(l(),a(p,null,[i.hidden?d("",!0):(l(),k(b,{key:i.name,label:i.label},{label:c(()=>[i.type==="variable"?(l(),a(p,{key:0},[j(h(i.label),1)],64)):(l(),a("div",Z,[t("span",null,h(i.label),1),r(I,null,{default:c(()=>[r(y)]),_:1})]))]),default:c(()=>[i.type==="variable"?(l(),k(S,{key:0,variable:i,variables:u.variables},null,8,["variable","variables"])):i.type==="group"?(l(),a("ul",ee,[(l(!0),a(p,null,w(i.children,V=>(l(),a("li",{key:`${i.name}_${V.name}`},[t("label",te,h(V.label),1),r(S,{variable:V},null,8,["variable"])]))),128))])):d("",!0)]),_:2},1032,["label"]))],64))),256))]),_:1})])],64)):d("",!0),se,n.withInstallButton?(l(),a("div",le,[r(m,{type:"important",onClick:_.install},{default:c(()=>[j(" INSTALL ")]),_:1},8,["onClick"])])):d("",!0)])])}const be=C(J,[["render",ne],["__scopeId","data-v-548041b5"]]);const ae={name:"IssueListView",components:{Pagination:G},data(){return{pagination:{pageIndex:1,capacity:10,total:100}}}},v=e=>(P("data-v-f510f853"),e=e(),$(),e),ie={class:"issue-wrap"},oe=v(()=>t("div",{class:"toolbar"},[t("ul",null,[t("li",null,"All"),t("li",null,"Enabled"),t("li",null,"Completed"),t("li",null,"Refused")]),t("ul",{class:"issue-types"},[t("li",{class:"bug"},"BUG"),t("li",{class:"optimize"},"Optimize")])],-1)),re={class:"issues"},ce=v(()=>t("h3",null,"登录失败时验证码没有刷新",-1)),ue={class:"text-info-1"},_e=v(()=>t("span",null,"刘大逵",-1)),de=v(()=>t("li",{class:"text-info-1"},[t("span",null,"Completed")],-1)),pe=v(()=>t("li",{class:"text-info-1"},[t("span",null,"3小时前")],-1));function he(e,s,n,f,u,_){const m=o("UserFilled"),g=o("el-icon"),b=o("router-link"),y=o("Pagination");return l(),a("div",ie,[oe,t("ul",re,[(l(),a(p,null,w(10,I=>t("li",{key:I},[r(b,{to:"#",target:"_blank"},{default:c(()=>[ce,t("ul",null,[t("li",ue,[r(g,null,{default:c(()=>[r(m)]),_:1}),_e]),de,pe])]),_:1})])),64))]),r(y,{pagination:u.pagination},null,8,["pagination"])])}const ge=C(ae,[["render",he],["__scopeId","data-v-f510f853"]]);export{ge as I,be as S};
