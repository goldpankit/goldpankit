import{S as n}from"./ServiceInstaller-f7e5ac2a.js";import{a as l}from"./service-7c141bb7.js";import{a as p}from"./service.space-4e310a85.js";import{_ as h,m as u,J as m,r as v,z as f,o as s,c as i,A as _,g as d,j}from"./index-38693b26.js";import"./ServiceCodeErrorWindow-1c3de638.js";import"./QueryModelView-c77a9554.js";import"./InnerRouterViewWindow-c5451133.js";import"./form.check-189b470c.js";import"./service.version-b38dea85.js";import"./FormItemTip-fee82ce6.js";const g={components:{ServiceInstaller:n},data(){return{loading:!0,route:{space:null,service:null,majorVersion:null},space:null,service:null,project:null}},computed:{...u(["currentProject"])},methods:{fetchSpace(){p(this.$route.params.spaceName).then(e=>{this.space=e}).catch(e=>{this.$tip.apiFailed(e)})},fetchService(){this.loading=!0,l({space:this.route.space,service:this.route.service,majorVersion:this.route.majorVersion}).then(e=>{this.service=e}).catch(e=>{this.$tip.apiFailed(e)}).finally(()=>{this.loading=!1})},handleProjectChange(e){e==null||e===""||m(e).then(r=>{this.project=r}).catch(r=>{this.$tip.apiFailed(r)})}},created(){this.route.space=this.$route.params.spaceName,this.route.service=this.$route.params.serviceName,this.route.majorVersion=this.$route.query.major,this.fetchSpace(),this.fetchService(),this.currentProject!=null&&this.handleProjectChange(this.currentProject)}},S={class:"page"},P={class:"wrap"};function y(e,r,C,V,t,c){const o=v("ServiceInstaller"),a=f("loading");return s(),i("div",S,[_((s(),i("div",P,[t.space!=null&&t.service!=null?(s(),d(o,{key:0,space:t.space.name,service:t.service.name,"service-price":t.service.price.price,"service-lease":t.service.latestLease,version:t.service.defaultMajorVersion.version,"project-config":t.project,"with-title":!0,"with-install-button":!0,onChangeProject:c.handleProjectChange,onInstalled:r[0]||(r[0]=k=>e.$router.push({name:"Workbench"}))},null,8,["space","service","service-price","service-lease","version","project-config","onChangeProject"])):j("",!0)])),[[a,t.loading]])])}const z=h(g,[["render",y],["__scopeId","data-v-f3ec5a6d"]]);export{z as default};
