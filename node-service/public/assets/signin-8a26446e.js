import{_ as h,n as k,q as w,u as b,v,r as i,o as $,c as y,a as r,t as a,b as t,w as n,i as V,x as q,e as c}from"./index-63997ccc.js";const D={data(){return{form:{username:"",password:""},loginData:{isWorking:!1}}},methods:{...k(["setUserInfo"]),getRules(){return{username:[{required:!0,message:this.$t("form.isRequired",{value:this.$t("user.username")})}],password:[{required:!0,message:this.$t("form.isRequired",{value:this.$t("user.password")})}]}},login(){this.$refs.form.validate().then(()=>{this.loginData.isWorking||(this.loginData.isWorking=!0,w({...this.form,username:this.form.username.trim()}).then(e=>e).then(e=>(document.cookie=`x-kit-token=${e};`,b(e))).then(()=>{v().then(e=>{this.setUserInfo(e);const s=this.$route.query.redirect_uri;if(s!=null&&s!=="")this.$router.push(s);else{const l=this.$router.options.history.state.back;l==null||l==="/signup"?this.$router.push({name:"Desktop"}):this.$router.back()}this.loginData.isWorking=!1})}).catch(e=>{this.$tip.apiFailed(e),this.loginData.isWorking=!1}))}).catch(()=>{})}}},I={class:"signup"},U={class:"wrap"},W={class:"login-box"},x={class:"create-account"};function B(e,s,l,C,o,u){const d=i("el-input"),p=i("el-form-item"),f=i("el-form"),_=i("el-button"),g=i("router-link");return $(),y("div",I,[r("div",U,[r("h2",null,a(e.$t("common.signIn")),1),t(f,{ref:"form",model:o.form,rules:u.getRules(),onSubmit:s[2]||(s[2]=V(()=>{},["stop"]))},{default:n(()=>[t(p,{label:e.$t("user.username"),prop:"username",required:""},{default:n(()=>[t(d,{modelValue:o.form.username,"onUpdate:modelValue":s[0]||(s[0]=m=>o.form.username=m),type:"text",size:"large"},null,8,["modelValue"])]),_:1},8,["label"]),t(p,{class:"password-item",label:e.$t("user.password"),prop:"password",required:""},{label:n(()=>[r("label",null,a(e.$t("user.password")),1)]),default:n(()=>[t(d,{modelValue:o.form.password,"onUpdate:modelValue":s[1]||(s[1]=m=>o.form.password=m),"show-password":"",type:"password",size:"large",onKeypress:q(u.login,["enter","native"])},null,8,["modelValue","onKeypress"])]),_:1},8,["label"])]),_:1},8,["model","rules"]),r("div",W,[r("div",null,[t(_,{type:"important",disabled:o.loginData.isWorking,onClick:u.login},{default:n(()=>[c(a(e.$t("common.signIn")),1)]),_:1},8,["disabled","onClick"])])])]),r("div",x,[t(g,{to:{name:"SignUp"}},{default:n(()=>[c(a(e.$t("user.createAccount")),1)]),_:1})])])}const K=h(D,[["render",B],["__scopeId","data-v-af851e27"]]);export{K as default};
