import{q as I,_ as k,r as i,o as d,g as D,w as s,a as n,b as t,e as m,t as u,c as p,F as b,p as g,k as C,C as E,D as W,E as F,m as B,h as M,f as T}from"./index-8f73103e.js";import{I as N,a as P,d as q}from"./database-3f2a6015.js";import{P as z}from"./Pagination-8d787349.js";const O={name:"DatabaseView",props:{database:{required:!0}},data(){return{hidden:{host:!0,username:!0,password:!0}}},methods:{...I(["setCurrentDatabase"]),gotoQueryModels(){this.setCurrentDatabase(this.database.id),this.$router.push({name:"DatabaseQueryModel"})}}},v=e=>(g("data-v-92c315f8"),e=e(),C(),e),Q={class:"content-wrap"},H=v(()=>n("span",{class:"content-holder"},"******",-1)),R={class:"content-wrap"},A=v(()=>n("span",{class:"content-holder"},"******",-1)),L={class:"content-wrap"},j=v(()=>n("span",{class:"content-holder"},"******",-1)),G={class:"toolbar"};function J(e,a,l,S,r,y){const c=i("el-descriptions-item"),f=i("View"),_=i("el-icon"),h=i("Hide"),w=i("el-button"),$=i("el-descriptions");return d(),D($,{title:l.database.name},{extra:s(()=>[n("ul",G,[n("li",null,[t(w,{size:"small",onClick:y.gotoQueryModels},{default:s(()=>[m(u(e.$t("database.queryModels")),1)]),_:1},8,["onClick"])]),n("li",null,[t(w,{size:"small",icon:"Edit",onClick:a[6]||(a[6]=o=>e.$emit("edit"))},{default:s(()=>[m(u(e.$t("common.edit")),1)]),_:1})]),n("li",null,[t(w,{size:"small",type:"danger",text:"",onClick:a[7]||(a[7]=o=>e.$emit("delete"))},{default:s(()=>[m(u(e.$t("common.delete")),1)]),_:1})])])]),default:s(()=>[t(c,{label:e.$t("database.databaseType")},{default:s(()=>[m(u(l.database.type),1)]),_:1},8,["label"]),t(c,{label:e.$t("database.host")},{default:s(()=>[n("div",Q,[r.hidden.host?(d(),p(b,{key:0},[H,t(_,{onClick:a[0]||(a[0]=o=>r.hidden.host=!1)},{default:s(()=>[t(f)]),_:1})],64)):(d(),p(b,{key:1},[n("span",null,u(l.database.host),1),t(_,{onClick:a[1]||(a[1]=o=>r.hidden.host=!0)},{default:s(()=>[t(h)]),_:1})],64))])]),_:1},8,["label"]),t(c,{label:e.$t("database.port")},{default:s(()=>[m(u(l.database.port),1)]),_:1},8,["label"]),t(c,{label:e.$t("database.schema")},{default:s(()=>[m(u(l.database.schema),1)]),_:1},8,["label"]),t(c,{label:e.$t("database.username")},{default:s(()=>[n("div",R,[r.hidden.username?(d(),p(b,{key:0},[A,t(_,{onClick:a[2]||(a[2]=o=>r.hidden.username=!1)},{default:s(()=>[t(f)]),_:1})],64)):(d(),p(b,{key:1},[n("span",null,u(l.database.username),1),t(_,{onClick:a[3]||(a[3]=o=>r.hidden.username=!0)},{default:s(()=>[t(h)]),_:1})],64))])]),_:1},8,["label"]),t(c,{label:e.$t("database.password")},{default:s(()=>[n("div",L,[r.hidden.password?(d(),p(b,{key:0},[j,t(_,{onClick:a[4]||(a[4]=o=>r.hidden.password=!1)},{default:s(()=>[t(f)]),_:1})],64)):(d(),p(b,{key:1},[n("span",null,u(l.database.password),1),t(_,{onClick:a[5]||(a[5]=o=>r.hidden.password=!0)},{default:s(()=>[t(h)]),_:1})],64))])]),_:1},8,["label"])]),_:1},8,["title"])}const K=k(O,[["render",J],["__scopeId","data-v-92c315f8"]]);const U={components:{FormTip:E,OperaDataSourceWindow:W,Pagination:z,Empty:F,DatabaseView:K,InnerRouterViewWindow:N,InnerRouterView:P},data(){return{pagination:{pageIndex:1,capacity:10,total:0}}},computed:{...B(["databases"])},methods:{...M(["fetchDatabases"]),edit(e){this.$refs.operaDataSourceWindow.open(e)},deleteDatabase(e){const a=this.databases.find(l=>l.id===e);if(a==null){this.$tip.error("未找到数据库信息，请刷新后重试！");return}this.deleteConfirm(`确认删除「${a.name}」数据库吗？`).then(()=>{q(e).then(()=>{this.fetchDatabases()}).catch(l=>{this.$tip.apiFailed(l)})}).catch(()=>{})}}},X=e=>(g("data-v-197735f9"),e=e(),C(),e),Y={class:"form"},Z={class:"wrap"},x=X(()=>n("h2",null,"数据库",-1)),ee={class:"database-list-wrap"},te={class:"toolbar"},ae={key:0,class:"database-list"};function se(e,a,l,S,r,y){const c=i("FormTip"),f=i("el-button"),_=i("DatabaseView"),h=i("Empty"),w=i("Pagination"),$=i("OperaDataSourceWindow");return d(),p("div",Y,[n("div",Z,[x,t(c,null,{default:s(()=>[m(u(e.$t("database.tip")),1)]),_:1}),n("div",ee,[n("ul",te,[n("li",null,[t(f,{type:"primary",onClick:a[0]||(a[0]=o=>e.$refs.operaDataSourceWindow.open())},{default:s(()=>[m(u(e.$t("database.addNewDatabase")),1)]),_:1})])]),e.databases.length>0?(d(),p("ul",ae,[(d(!0),p(b,null,T(e.databases,o=>(d(),p("li",{key:o.name},[t(_,{database:o,onEdit:V=>y.edit(o),onDelete:V=>y.deleteDatabase(o.id)},null,8,["database","onEdit","onDelete"])]))),128))])):(d(),D(h,{key:1,description:"暂无数据库配置"})),t(w,{pagination:r.pagination},null,8,["pagination"])])]),t($,{ref:"operaDataSourceWindow"},null,512)])}const de=k(U,[["render",se],["__scopeId","data-v-197735f9"]]);export{de as default};
