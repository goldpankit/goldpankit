import{_ as D,E as N,m as L,K as E,r as a,o as r,c as o,b as s,t as c,d as u,F as _,x as P,u as m,I as h,v as f,J as k,w as S,f as w,g as v,p as x,h as z}from"./index-f2a25bd4.js";import{I as U,S as B}from"./IssueListView-8a0f8f6b.js";import{a as T}from"./service-7069bde1.js";import{M as A}from"./MarkdownEditor-a38a5933.js";import"./service.version-50db337e.js";import"./Pagination-f2621c08.js";const F={components:{IssueListView:U,Empty:N,MarkdownEditor:A,ServiceInstaller:B},data(){return{space:null,mainService:null,currentService:null,version:"v1",subServices:[],currentServiceDimension:"readme",project:null}},watch:{currentProject(){this.fetchProject(!0)}},computed:{...L(["currentProject"]),installed(){return this.currentService==null?!1:(console.log("this.project.services",this.project.services),this.project.services[this.currentService.name]!=null)}},methods:{fetchProject(t=!1){E(this.currentProject).then(i=>{this.project=i,this.space=this.project.space;let p=null;for(const b in this.project.main){p=b;break}this.mainService={name:p,...this.project.main[p]},t&&this.searchSubServices()}).catch(i=>{this.$tip.apiFailed(i)})},searchSubServices(){T({space:this.space,service:this.mainService.name,majorVersion:this.mainService.version.split(".")[0]}).then(t=>{this.subServices=t,this.subServices.length>0&&this.selectService(this.subServices[0])}).catch(t=>{this.$tip.apiFailed(t)})},selectService(t){this.currentService=t},hasNewVersion(t){const i=this.project.services[t.name];return i==null?!1:i.version!==t.lastVersion}},created(){this.fetchProject(!0)}},y=t=>(x("data-v-6b773cdf"),t=t(),z(),t),M={class:"page"},R={key:0,class:"wrap"},G={class:"header"},J={class:"title"},K={class:"service-info"},Y={class:"info"},q=y(()=>s("p",null,"current version",-1)),H={class:"content-wrap"},O={class:"service-wrap"},Q={class:"search-box"},W={key:0,class:"service-list"},X=["onClick"],Z={key:0},$={class:"text-info-1 text-mini"},ee={class:"setting-wrap"},se={class:"main"},ie={class:"service-dimensions"},te={class:"dimension-content"},ne={class:"issue-wrap"},re={class:"opera"},ce={key:1,class:"setting-holder"},oe=y(()=>s("h4",null,"Sub Service Settings",-1)),le=y(()=>s("p",null,"You can open Settings by clicking on sub services on the left.",-1)),ae=[oe,le];function ue(t,i,p,b,e,l){const g=a("el-input"),j=a("Empty"),I=a("MarkdownEditor"),V=a("ServiceInstaller"),C=a("IssueListView"),d=a("el-button");return r(),o("div",M,[e.space!=null?(r(),o("div",R,[s("div",null,[s("div",G,[s("div",J,[s("h2",null,c(e.project.name),1),s("p",K,c(e.space)+" · "+c(e.mainService.name)+" · v"+c(e.mainService.version),1)]),s("div",Y,[s("em",null,c(e.version),1),q])]),s("div",H,[s("div",O,[s("div",Q,[u(g,{size:"large",placeholder:"Search"})]),e.subServices.length>0?(r(),o("ul",W,[(r(!0),o(_,null,P(e.subServices,n=>(r(),o("li",{key:n.id,class:h({selected:e.currentService!=null&&e.currentService.name===n.name}),onClick:ve=>l.selectService(n)},[s("h5",null,[v(c(n.name)+" ",1),l.hasNewVersion(n)?(r(),o("em",Z,"Upgradable")):w("",!0)]),s("p",null,c(n.lastVersion),1),s("p",null,c(n.introduce),1),s("p",$,"Last publish: "+c(n.lastPublishTime),1)],10,X))),128))])):(r(),m(j,{key:1,description:"No Sub Services"}))]),s("div",ee,[e.currentService!=null?(r(),o(_,{key:0},[s("h3",null,c(e.currentService.name),1),s("div",se,[s("ul",ie,[s("li",{class:h({selected:e.currentServiceDimension==="readme"}),onClick:i[0]||(i[0]=n=>e.currentServiceDimension="readme")},"Readme",2),s("li",{class:h({selected:e.currentServiceDimension==="install"}),onClick:i[1]||(i[1]=n=>e.currentServiceDimension="install")},"Install",2),s("li",{class:h({selected:e.currentServiceDimension==="issues"}),onClick:i[2]||(i[2]=n=>e.currentServiceDimension="issues")},"Issues",2)]),s("div",te,[f(s("div",null,[u(I,{modelValue:e.currentService.description,"onUpdate:modelValue":i[3]||(i[3]=n=>e.currentService.description=n),readonly:"","without-padding":!0},null,8,["modelValue"])],512),[[k,e.currentServiceDimension==="readme"]]),f(u(V,{ref:"installer",space:e.space,service:e.currentService.name,version:e.currentService.lastVersion,"with-project":!1,"project-config":e.project,onInstalled:i[4]||(i[4]=n=>l.fetchProject()),onUninstalled:i[5]||(i[5]=n=>l.fetchProject())},null,8,["space","service","version","project-config"]),[[k,e.currentServiceDimension==="install"]]),s("div",ne,[f(u(C,null,null,512),[[k,e.currentServiceDimension==="issues"]])])])]),s("div",re,[l.installed?(r(),o(_,{key:0},[l.hasNewVersion(e.currentService)?(r(),m(d,{key:0,type:"primary",size:"large",icon:"Upload",onClick:i[6]||(i[6]=n=>t.$refs.installer.install())},{default:S(()=>[v("UPGRADE")]),_:1})):(r(),m(d,{key:1,type:"primary",size:"large",onClick:i[7]||(i[7]=n=>t.$refs.installer.install())},{default:S(()=>[v("REINSTALL")]),_:1})),u(d,{size:"large",onClick:i[8]||(i[8]=n=>t.$refs.installer.uninstall())},{default:S(()=>[v("UNINSTALL")]),_:1})],64)):(r(),m(d,{key:1,type:"primary",size:"large",onClick:i[9]||(i[9]=n=>t.$refs.installer.install())},{default:S(()=>[v("INSTALL")]),_:1}))])],64)):(r(),o("div",ce,ae))])])])])):w("",!0)])}const fe=D(F,[["render",ue],["__scopeId","data-v-6b773cdf"]]);export{fe as default};
