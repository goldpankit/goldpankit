import{u as f,_ as v,r as a,o as s,c,a as o,t as d,b as i,w as y,e as P,F as p,f as m,n as k,j as g}from"./index-2937f55a.js";function w(){return f.get("/local/file/runtime/root")}function S(e){return f.get(`/local/file/list?target=${e}`)}function A(e){return f.get(`/local/directory/create?path=${e}`)}const x={name:"DirectorySelect",props:{modelValue:{},title:{default:"Select Directory"}},data(){return{paths:[],files:[]}},methods:{createDirectory(){this.files.push({path:"",type:"directory",__creatable:!0,__working_create:!1})},confirmCreateDirectory(e){e.__working_create||(e.__working_create=!0,A(this.__getAbsolutePath(e.path)).then(()=>{e.__creatable=!1,this.__sortFiles()}).catch(l=>{console.log("e",l)}).finally(()=>{e.__working_create=!1}))},cancelCreateDirectory(e){this.files.splice(e,1)},changePath(e){e!==this.paths.length-1&&(this.paths=this.paths.splice(0,e+1),this.__fetchFiles(),this.$emit("update:modelValue",this.__getAbsolutePath()))},fetchSubFiles(e){e.__creatable||e.type!=="file"&&(this.paths.push(e.path),this.__fetchFiles(),this.$emit("update:modelValue",this.__getAbsolutePath()))},__fetchFiles(){S(this.__getAbsolutePath()).then(e=>{console.log("files",e),this.files=e,this.__sortFiles()}).catch(e=>{console.log("e",e)})},__fetchDefaultPaths(){w().then(e=>{this.paths=e.split("/").filter(l=>l!==""),this.__fetchFiles(),this.$emit("update:modelValue",this.__getAbsolutePath())}).catch(e=>{console.log("e",e)})},__getAbsolutePath(e){return`/${this.paths.join("/")}${e==null?"":"/"+e}`},__sortFiles(){this.files=this.files.sort((e,l)=>e.type==="directory"&&l.type==="directory"?e.path>l.path?-1:1:e.type==="directory"?-1:1)}},created(){if(this.modelValue==null||this.modelValue===""){this.__fetchDefaultPaths();return}this.paths=this.modelValue.split("/").filter(e=>e!==""),this.__fetchFiles()}},$={class:"directory-select"},B={class:"header"},N={class:"opera"},R={class:"paths"},j=["onClick"],I={class:"files"},U=["onClick"],z={key:0,class:"new-directory"};function E(e,l,b,L,u,r){const _=a("el-button"),C=a("el-input"),D=a("Folder"),F=a("Document"),V=a("el-icon");return s(),c("div",$,[o("div",B,[o("h4",null,d(b.title),1),o("div",N,[i(_,{class:"button-icon",icon:"Refresh",onClick:r.__fetchFiles},null,8,["onClick"]),i(_,{type:"primary",icon:"Plus",onClick:r.createDirectory},{default:y(()=>[P("New Folder")]),_:1},8,["onClick"])])]),o("ul",R,[(s(!0),c(p,null,m(u.paths,(t,h)=>(s(),c("li",{key:t,class:k({current:h===u.paths.length-1}),onClick:n=>r.changePath(h)},d(t),11,j))),128))]),o("div",I,[o("ul",null,[(s(!0),c(p,null,m(u.files,(t,h)=>(s(),c("li",{key:t.path,class:k({"is-file":t.type==="file"}),onClick:n=>r.fetchSubFiles(t)},[t.__creatable?(s(),c("div",z,[i(C,{modelValue:t.path,"onUpdate:modelValue":n=>t.path=n,placeholder:"unknown directory"},null,8,["modelValue","onUpdate:modelValue"]),i(_,{type:"primary",class:"button-icon",icon:"Select",disabled:t.__working_create,onClick:n=>r.confirmCreateDirectory(t)},null,8,["disabled","onClick"]),i(_,{icon:"Close",class:"button-icon",onClick:n=>r.cancelCreateDirectory(h)},null,8,["onClick"])])):(s(),c(p,{key:1},[i(V,null,{default:y(()=>[t.type==="directory"?(s(),g(D,{key:0})):(s(),g(F,{key:1}))]),_:2},1024),o("p",null,d(t.path),1)],64))],10,U))),128))])])])}const q=v(x,[["render",E],["__scopeId","data-v-9a36285c"]]);export{q as D};
