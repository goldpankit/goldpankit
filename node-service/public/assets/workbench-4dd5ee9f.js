import{_ as D,m as W,n as P,J as U,r as o,o as l,c as v,a as i,t,b as c,w as u,F as b,H as h,A as _,I as f,g as S,j,e as p,p as A,l as E}from"./index-6afa8d1b.js";import{S as B,I as T,a as z}from"./IssueListView-651f7c3e.js";import{a as M}from"./service-21be9986.js";import{M as F}from"./MarkdownEditor-cdd9c50d.js";import{E as G}from"./Empty-5b594ef0.js";import{B as x}from"./BeanAmount-1c446a97.js";import"./service.version-d4a7aa8f.js";import"./Pagination-f09bf09f.js";const R={components:{SubServiceList:B,BeanAmount:x,IssueListView:T,Empty:G,MarkdownEditor:F,ServiceInstaller:z},data(){return{isWorking:{install:!1,uninstall:!1},space:null,mainService:null,currentService:null,version:"v1",subServices:[],currentServiceDimension:"readme",project:null}},watch:{currentProject(){this.fetchProject(!0)}},computed:{...W(["currentProject"]),installed(){return this.currentService==null?!1:this.project.services[this.currentService.name]!=null}},methods:{...P(["setCurrentProject"]),fetchProject(n=!1){U(this.currentProject).then(s=>{this.project=s,this.space=this.project.space;let m=null;for(const g in this.project.main){m=g;break}this.mainService={name:m,...this.project.main[m]},n&&this.searchSubServices()}).catch(s=>{this.$tip.apiFailed(s)})},searchSubServices(){M({space:this.space,service:this.mainService.name,majorVersion:this.mainService.version.split(".")[0]}).then(n=>{this.subServices=n,this.subServices.length>0&&this.selectService(this.subServices[0])}).catch(n=>{this.$tip.apiFailed(n)})},selectService(n){this.currentService=n},hasNewVersion(n){const s=this.project.services[n.name];return s==null?!1:s.version!==n.lastVersion}},created(){const n=this.$route.query.project_id;n!=null&&n!==""&&(this.setCurrentProject(n),this.$router.replace({name:"Workbench"})),this.fetchProject(!0)}},k=n=>(A("data-v-ebab9431"),n=n(),E(),n),q={class:"page"},H={key:0,class:"wrap"},J={class:"header"},Y={class:"title"},K={class:"service-info"},O={class:"info"},Q=k(()=>i("p",null,"current version",-1)),X={class:"content-wrap"},Z={class:"service-wrap"},$={class:"search-box"},ee={class:"setting-wrap"},se={class:"main"},ie={class:"service-dimensions"},ne={class:"dimension-content"},re={class:"issue-wrap"},te={class:"opera"},le={key:1,class:"setting-holder"},oe=k(()=>i("h4",null,"Sub Service Settings",-1)),ce=k(()=>i("p",null,"You can open Settings by clicking on sub services on the left.",-1)),ae=[oe,ce];function ue(n,s,m,g,e,a){const y=o("el-input"),I=o("Upload"),w=o("el-icon"),L=o("SubServiceList"),N=o("MarkdownEditor"),V=o("ServiceInstaller"),C=o("IssueListView"),d=o("el-button");return l(),v("div",q,[e.space!=null?(l(),v("div",H,[i("div",null,[i("div",J,[i("div",Y,[i("h2",null,t(e.project.name),1),i("p",K,t(e.space)+" · "+t(e.mainService.name)+" · v"+t(e.mainService.version),1)]),i("div",O,[i("em",null,t(e.version),1),Q])]),i("div",X,[i("div",Z,[i("div",$,[c(y,{size:"large",placeholder:"Search"})]),c(L,{services:e.subServices,"custom-class":r=>({selected:e.currentService!=null&&e.currentService.name===r.name}),onClick:s[0]||(s[0]=r=>a.selectService(r))},{title:u(({service:r})=>[p(t(r.name)+" ",1),a.hasNewVersion(r)?(l(),S(w,{key:0},{default:u(()=>[c(I)]),_:1})):j("",!0)]),_:1},8,["services","custom-class"])]),i("div",ee,[e.currentService!=null?(l(),v(b,{key:0},[i("h3",null,t(e.currentService.name),1),i("div",se,[i("ul",ie,[i("li",{class:h({selected:e.currentServiceDimension==="readme"}),onClick:s[1]||(s[1]=r=>e.currentServiceDimension="readme")},"Readme",2),i("li",{class:h({selected:e.currentServiceDimension==="install"}),onClick:s[2]||(s[2]=r=>e.currentServiceDimension="install")},"Install",2),i("li",{class:h({selected:e.currentServiceDimension==="issues"}),onClick:s[3]||(s[3]=r=>e.currentServiceDimension="issues")},"Issues",2)]),i("div",ne,[_(i("div",null,[c(N,{modelValue:e.currentService.description,"onUpdate:modelValue":s[4]||(s[4]=r=>e.currentService.description=r),readonly:"","without-padding":!0},null,8,["modelValue"])],512),[[f,e.currentServiceDimension==="readme"]]),_(c(V,{ref:"installer",installing:e.isWorking.install,"onUpdate:installing":s[5]||(s[5]=r=>e.isWorking.install=r),uninstalling:e.isWorking.uninstall,"onUpdate:uninstalling":s[6]||(s[6]=r=>e.isWorking.uninstall=r),space:e.space,service:e.currentService.name,"service-type":e.currentService.type,"service-price":e.currentService.price.price,"service-lease":e.currentService.latestLease,version:e.currentService.lastVersion,"with-project":!1,"project-config":e.project,onInstalled:s[7]||(s[7]=r=>a.fetchProject()),onUninstalled:s[8]||(s[8]=r=>a.fetchProject())},null,8,["installing","uninstalling","space","service","service-type","service-price","service-lease","version","project-config"]),[[f,e.currentServiceDimension==="install"]]),i("div",re,[_(c(C,null,null,512),[[f,e.currentServiceDimension==="issues"]])])])]),i("div",te,[a.installed?(l(),v(b,{key:0},[a.hasNewVersion(e.currentService)?(l(),S(d,{key:0,type:"primary",size:"large",icon:"Upload",disabled:e.isWorking.install,onClick:s[9]||(s[9]=r=>n.$refs.installer.install())},{default:u(()=>[p("UPGRADE")]),_:1},8,["disabled"])):(l(),S(d,{key:1,type:"primary",size:"large",disabled:e.isWorking.install,onClick:s[10]||(s[10]=r=>n.$refs.installer.install())},{default:u(()=>[p(t(e.isWorking.install?"INSTALLING...":"REINSTALL"),1)]),_:1},8,["disabled"])),c(d,{size:"large",disabled:e.isWorking.uninstall,onClick:s[11]||(s[11]=r=>n.$refs.installer.uninstall())},{default:u(()=>[p(t(e.isWorking.uninstall?"UNINSTALLING...":"UNINSTALL"),1)]),_:1},8,["disabled"])],64)):(l(),S(d,{key:1,type:"primary",size:"large",disabled:e.isWorking.install,onClick:s[12]||(s[12]=r=>n.$refs.installer.install())},{default:u(()=>[p(t(e.isWorking.install?"INSTALLING...":"INSTALL"),1)]),_:1},8,["disabled"]))])],64)):(l(),v("div",le,ae))])])])])):j("",!0)])}const ke=D(R,[["render",ue],["__scopeId","data-v-ebab9431"]]);export{ke as default};
