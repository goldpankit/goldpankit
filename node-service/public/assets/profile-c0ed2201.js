import{_,r,o as p,g as U,w as f,a as s,m as y,n as g,T as I,c as u,b as c,t as i,j as b,e as V}from"./index-edfb6a04.js";const k={name:"AvatarUploader",props:{modelValue:{required:!0}},methods:{handleAvatarSuccess(e){if(!e.success){this.$tip.apiFailed(e);return}this.$emit("update:modelValue",e.data.accessUri)},beforeAvatarUpload(e){return e.size/1024/1024>2?(this.$tip.error("Avatar picture size can not exceed 2MB!"),!1):!0}}},A=["src"];function w(e,a,d,m,o,t){const n=r("el-upload");return p(),U(n,{class:"avatar-uploader",action:"/remote-api/upload/image","show-file-list":!1,accept:".jpeg,.png,.jpg,.gif","on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload},{default:f(()=>[s("img",{src:e.getAccessUri(d.modelValue),class:"avatar"},null,8,A)]),_:1},8,["on-success","before-upload"])}const x=_(k,[["render",w],["__scopeId","data-v-b341388d"]]);const N={components:{AvatarUploader:x},computed:{...y(["userInfo"])},data(){return{copyUserInfo:null,isWorking:!1}},watch:{userInfo:{immediate:!0,handler:function(){this.copyUserInfo=JSON.parse(JSON.stringify(this.userInfo))}}},methods:{...g(["setUserInfo"]),save(){this.isWorking||(this.isWorking=!0,I(this.copyUserInfo).then(()=>{this.setUserInfo(this.copyUserInfo)}).catch(e=>{this.$tip.apiFailed(e)}).finally(()=>{this.isWorking=!1}))}}},S={class:"page"},$={key:0,class:"wrap"},B={class:"avatar-wrap"},C={class:"introduce-wrap"},W={class:"opera"};function j(e,a,d,m,o,t){const n=r("AvatarUploader"),v=r("el-input"),h=r("el-button");return p(),u("div",S,[o.copyUserInfo!=null?(p(),u("div",$,[s("div",B,[c(n,{modelValue:o.copyUserInfo.avatar,"onUpdate:modelValue":a[0]||(a[0]=l=>o.copyUserInfo.avatar=l)},null,8,["modelValue"]),s("h2",null,i(o.copyUserInfo.username),1)]),s("div",C,[s("label",null,i(e.$t("common.introduce")),1),c(v,{modelValue:o.copyUserInfo.introduce,"onUpdate:modelValue":a[1]||(a[1]=l=>o.copyUserInfo.introduce=l),type:"textarea",rows:5},null,8,["modelValue"])]),s("div",W,[c(h,{type:"primary",size:"large",disabled:o.isWorking,onClick:t.save},{default:f(()=>[V(i(e.$t("common.save")),1)]),_:1},8,["disabled","onClick"])])])):b("",!0)])}const F=_(N,[["render",j],["__scopeId","data-v-eb8e6ba5"]]);export{F as default};
